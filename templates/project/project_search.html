{% extends 'base.html' %}

{% block title %}Projects{% endblock title %}

{% block content %}
    <!-- <div class="container5"> -->
    <div class="backg">
        <div id="project_map"></div>
        <br>
        <br>
        <br>
        <div class="row">

            <div class="col-sm-10" id="createproj">
                <div class="input-panel">
                    <a href="{% url 'project_create' %}" class="btn btn-primary btn-lg" id="button1"
                       role="button"><span class="glyphicon glyphicon-plus-sign"></span> Create New
                        Project</a>
                </div>
            </div>


            <div class="col-sm-1"></div>
        </div>
        <br>

        <br>
        <div class="container5">

            <div class="row">
                <!--   <div class="col-sm-7"> -->

                <!-- <div id="project_map"> -->

                <script>

                    var mymap = L.map('project_map').setView([51.505, -0.09], 13);
                    var markerList = [];

                    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
                        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                        maxZoom: 18,
                        id: 'mapbox/streets-v11',
                        tileSize: 512,
                        zoomOffset: -1,
                        accessToken: 'pk.eyJ1IjoidmFsa2FsYWlzIiwiYSI6ImNrZGhpZ29peTFnMjIycG5ybWR3aG4yeHIifQ.L4y4PQjkIdO1c7pvzOr2kw'
                    }).addTo(mymap);

                    {% for project in project_list %}

                        var marker = L.marker([{{project.latitude}}, {{project.longitude}}]).addTo(mymap);
                        marker.bindPopup("<b>Name: {{project.name}}</b><br>Country: {{project.country}}<br>Latitude: {{project.latitude}}<br>Longitude: {{project.longitude}}").openPopup();
                        markerList.push(marker);
                    {% endfor %}

                    var group = new L.featureGroup(markerList);
                    mymap.fitBounds(group.getBounds().pad(0.5));

                </script>
                <!--   </div> -->
                <!--  </div> -->
                <div class="col-sm-1">

                </div>
                <div class="col-sm-9" id="box1">
                    <div class="panel panel-default" id="box2">
                        <div class="panel-heading"><h3 class="panel-title" id="listtitle"><strong>Project List </strong>
                        </h3></div>
                    <br>
                        <div class="panel-body" id="list5">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead class="thead-dark">
                                    <tr>
                                        <th>#ID</th>

                                        <th>Project Name</th>


                                        <th>Date Created</th>
                                        <th>Last Modified</th>
                                        <th>Country</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    {% for project in project_list %}
                                        <tr id="list6">
                                            <th scope="row">{{ forloop.counter }}</th>
                                            <td>{{ project.name }}</td>
                                            <td>{{ project.date_created }}</td>
                                            <td>{{ project.date_updated }}</td>
                                            <td>{{ project.country }}</td>
                                            <td>


                                                <form style="float: left;" class="form"
                                                      action="{% url 'scenario_search' project.pk %}"
                                                      method="GET">
                                                    <input class="btn btn-sm btn-success" type="submit" value="Open"/>&emsp;
                                                </form>
                                                <form style="float: left;" class="form"
                                                      action="{% url 'project_detail' project.pk %}"
                                                      method="GET">
                                                    <input class="btn btn-sm btn-info" type="submit" value="Show"/>&emsp;
                                                </form>
                                                <form style="float: left;" class="form"
                                                      action="{% url 'project_update' project.pk %}"
                                                      method="GET">
                                                    <input class="btn btn-sm btn-default" type="submit" value="Edit"/>&emsp;
                                                </form>
                                                <form style="float: left;" class="form"
                                                      action="{% url 'project_delete' project.pk %}"
                                                      method="POST">
                                                    {% csrf_token %}
                                                    <input class="btn btn-sm btn-danger" type="submit" value="Delete"
                                                           onclick="return confirm('Are you sure you want to delete?' + '\n' +
                             'This will also delete all related project data.')"/>
                                                </form>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>


                    <!--   <div id="project_map"></div>

                <script>

                    var mymap = L.map('project_map').setView([51.505, -0.09], 13);
                    var markerList = [];

                    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
                        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                        maxZoom: 18,
                        id: 'mapbox/streets-v11',
                        tileSize: 512,
                        zoomOffset: -1,
                        accessToken: 'pk.eyJ1IjoidmFsa2FsYWlzIiwiYSI6ImNrZGhpZ29peTFnMjIycG5ybWR3aG4yeHIifQ.L4y4PQjkIdO1c7pvzOr2kw'
                    }).addTo(mymap);

                    {% for project in project_list %}

                        var marker = L.marker([{{project.latitude}}, {{project.longitude}}]).addTo(mymap);
                        marker.bindPopup("<b>Name: {{project.name}}</b><br>Country: {{project.country}}<br>Latitude:
                    {{project.latitude}}<br>Longitude: {{project.longitude}}").openPopup();
                        markerList.push(marker);
                    {% endfor %}

                    var group = new L.featureGroup(markerList);
                    mymap.fitBounds(group.getBounds().pad(0.5));

                </script> !-->
                </div>
                <!--  <div class="col-sm-1"></div> -->

                <div class="col-sm-2">
                    <div class="colorss">
                        <img src="/static/images/pic3.jpg"
                             style="width: 100%; height: 100%; opacity: 0.5; object-fit: cover; "/>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <br>
    <br>
    </div>
{% endblock content %}